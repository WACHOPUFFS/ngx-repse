<nb-layout>
  <nb-layout-column>
    <div class="container d-flex flex-column align-items-center justify-content-center">
      <!-- Fila 1: Tarjetas superiores -->
      <div class="row w-100">
        <!-- Primera Tarjeta -->
        <div class="col-md-6 mb-4">
          <div class="card shadow-sm fixed-height">
            <div class="card-body text-center">
              <h5 class="fw-bold">Selecciona la Semana Laboral</h5>
              <nb-select
                placeholder="Selecciona una semana"
                [(selected)]="selectedWeek"
                (selectedChange)="onWeekChange($event)"
              >
                <nb-option *ngFor="let week of weeks" [value]="week">
                  {{ week.week_number }}
                </nb-option>
              </nb-select>
              <div *ngIf="selectedWeek" class="mt-3">
                <p><strong>Inicio del Periodo:</strong> {{ selectedWeek.start_date || 'No disponible' }}</p>
                <p><strong>Fin del Periodo:</strong> {{ selectedWeek.end_date || 'No disponible' }}</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Segunda Tarjeta -->
        <div class="col-md-6 mb-4 text-center">
          <div class="card shadow-sm fixed-height">
            <div class="card-body">
              <h5 class="fw-bold">Selecciona el Día</h5>
              <nb-select fullWidth
                placeholder="Selecciona un día"
                [(selected)]="selectedDia"
                (selectedChange)="onDiaChange($event)"
              >
                <nb-option *ngFor="let dia of diasSemana" [value]="dia.date">
                  {{ dia.display }} | {{ dia.date }}
                </nb-option>
              </nb-select>
              <div *ngIf="diasSemana.length > 0 && selectedDia; else noDias" class="text-success dia-txt">
                <strong>Día seleccionado: {{ getFormattedDate2(selectedDia) }} </strong>
              </div>
              <ng-template #noDias>
                <div class="text-danger dia-txt">
                  <strong>Día seleccionado:</strong>
                </div>
              </ng-template>
            </div>
          </div>
        </div>
      </div>

      <!-- Fila 2: Tarjetas inferiores (Empleados) -->
      <div class="row w-100">
        <!-- Empleados Asignados -->
        <div class="col-md-6 mb-4">
          <nb-card>
            <nb-card-header>
              <h5 class="fw-bold">Empleados Asignados a Proyectos</h5>
            </nb-card-header>
            <nb-card-body>
              <nb-input
                fullWidth
                placeholder="Buscar empleado asignado"
                [(ngModel)]="searchAssigned"
                (input)="filterAssignedEmployees()"
              ></nb-input>
              <nb-list>
                <nb-list-item
                  *ngFor="let employee of filteredAssignedEmployees"
                  class="d-flex align-items-center"
                >
                  <nb-checkbox [(ngModel)]="employee.selected" class="me-2"></nb-checkbox>
                  <span>{{ employee.first_name }} {{ employee.middle_name }} {{ employee.last_name }}</span>
                </nb-list-item>
              </nb-list>
              <p *ngIf="filteredAssignedEmployees.length === 0" class="text-muted">No hay empleados asignados a proyectos.</p>
              <button nbButton status="info" fullWidth (click)="changeHoursToSelected(true)">
                <nb-icon icon="clock-outline"></nb-icon> Asignar Horas a Seleccionados
              </button>
              <button nbButton status="danger" fullWidth (click)="addIncidentToSelected(true)">
                <nb-icon icon="alert-circle-outline"></nb-icon> Asignar Incidencia a Seleccionados
              </button>
            </nb-card-body>
          </nb-card>
        </div>

        <!-- Empleados No Asignados -->
        <div class="col-md-6 mb-4">
          <nb-card>
            <nb-card-header>
              <h5 class="fw-bold">Empleados No Asignados a Proyectos</h5>
            </nb-card-header>
            <nb-card-body>
              <nb-input
                fullWidth
                placeholder="Buscar empleado no asignado"
                [(ngModel)]="searchUnassigned"
                (input)="filterUnassignedEmployees()"
              ></nb-input>
              <div class="scroll-container">
                <nb-list>
                  <nb-list-item
                    *ngFor="let employee of filteredUnassignedEmployees"
                    class="d-flex align-items-center"
                  >
                    <nb-checkbox [(ngModel)]="employee.selected" class="me-2"></nb-checkbox>
                    <span>{{ employee.first_name }} {{ employee.middle_name }} {{ employee.last_name }}</span>
                  </nb-list-item>
                </nb-list>
              </div>
              <p *ngIf="filteredUnassignedEmployees.length === 0" class="text-muted">No hay empleados no asignados a proyectos.</p>
              <button nbButton status="info" fullWidth (click)="changeHoursToSelected(false)">
                <nb-icon icon="clock-outline"></nb-icon> Asignar Horas a Seleccionados
              </button>
              <button nbButton status="danger" fullWidth (click)="addIncidentToSelected(false)">
                <nb-icon icon="alert-circle-outline"></nb-icon> Asignar Incidencia a Seleccionados
              </button>
            </nb-card-body>
          </nb-card>
        </div>
      </div>
    </div>
  </nb-layout-column>
</nb-layout>
