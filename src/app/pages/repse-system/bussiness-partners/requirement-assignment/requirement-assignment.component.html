<nb-card>
  <nb-card-header>Asignación de requisitos a proveedores</nb-card-header>
  <nb-card-body class="d-flex flex-column">
    <div class="form-container">
      <ngx-requirement-assignment-form
        [isForCompany]="false"
        [providers]="businessPartners"
        [assignedByCompanyId]="companyId"
        [documentTypes]="documentTypes"
        [availableFormats]="availableFormats"
        (formSubmitted)="loadAssignedRequirements()"
      ></ngx-requirement-assignment-form>
    </div>

    <hr />

    <div *ngIf="requirements.length > 0">
      <h4>Requisitos asignados a proveedores</h4>
      <div class="table-responsive">
        <table class="table" nbTable>
          <thead class="text-center">
            <tr>
              <th>Proveedor</th>
              <th>Documento</th>
              <th>Periódico</th>
              <th>Periodicidad</th>
              <th>Estado</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let req of requirements">
              <td class="align-middle">{{ req.company_name }}</td>
              <td class="align-middle">{{ req.name }}</td>
              <td class="text-center align-middle">
                {{ req.is_periodic ? "Sí" : "No" }}
              </td>
              <td class="text-center align-middle">
                {{
                  !req.is_periodic || req.periodicity_type === null
                    ? "Sin periodicidad"
                    : "Cada " +
                      req.periodicity_count +
                      " " +
                      req.periodicity_type
                }}
              </td>
              <td class="text-center">
                <nb-tag
                  appearance="outline"
                  [status]="getStatusColor(req.status)"
                  [text]="getStatusLabel(req.status)"
                ></nb-tag>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </nb-card-body>
</nb-card>
